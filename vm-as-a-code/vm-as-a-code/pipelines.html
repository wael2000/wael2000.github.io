<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vm as a service :: vm as a service</title>
    <link rel="canonical" href="https://wael2000.github.io/vm-as-a-code/vm-as-a-code/pipelines.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="webconsole.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../assets/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../assets/img/RHDLogo.svg" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="<link rel="canonical" href="https://wael2000.github.io/vm-as-a-code/vm-as-a-code">vm as a service</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="vm-as-a-code" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">

      <ul class="nav-list">
      <li class="nav-item" data-depth="0">
      <ul class="nav-list">
        <li class="nav-item is-current-page" data-depth="1">
          <a class="nav-link" href="pipelines.html">1. Pipelines</a>
        </li>
        <li class="nav-item" data-depth="1">
          <a class="nav-link" href="webconsole.html">2. Web Console</a>
        </li>

        </ul>
        </li>
      </ul>


  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">vm as a service</a></li>
    <li><a href="pipelines.html">Pipelines</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">vm as a service</h1>
<div class="sect1">

<h2 id="_pipeline"><a class="anchor" href="#_pipeline"></a>Pipeline</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Developers need not to install any local tools as following tools are provides as part of the workshop setup:</p>
</div>


<div class="literalblock">
<div class="content">
<pre>Examine the following pipelie:</pre>
</div>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">apiVersion: tekton.dev/v1
kind: Pipeline
metadata:
  name: vm-as-a-service
spec:
  params:
    - default: create
      description: create or delete
      name: action
      type: string
    - default: pss
      name: tenant
      type: string
    - default: main
      name: REVISION
      type: string
  tasks:
    - name: git-clone
      params:
        - name: refspec
          value: ''
        - name: submodules
          value: 'true'
        - name: depth
          value: '1'
        - name: sslVerify
          value: 'true'
        - name: crtFileName
          value: ca-bundle.crt
        - name: subdirectory
          value: ''
        - name: sparseCheckoutDirectories
          value: ''
        - name: deleteExisting
          value: 'true'
        - name: httpProxy
          value: ''
        - name: httpsProxy
          value: ''
        - name: noProxy
          value: ''
        - name: verbose
          value: 'true'
        - name: gitInitImage
          value: >-
            registry.redhat.io/openshift-pipelines/pipelines-git-init-rhel8@sha256:868966ef9d4b54952d8a74eb83bba40eb1f52c0148994fa704efd0e3797c61c5
        - name: userHome
          value: /home/git
        - name: URL
          value: https://github.com/Caseraw/OpenShiftDemoTime
        - name: REVISION
          value: $(params.REVISION)
      taskRef:
        params:
          - name: kind
            value: task
          - name: name
            value: git-clone
          - name: namespace
            value: openshift-pipelines
        resolver: cluster
      workspaces:
        - name: output
          workspace: source
    - name: provision-vms
      params:
        - name: SCRIPT
          value: >-
            sed -e 's/TENANT/$(params.tenant)/g' scenarios/uc02-vm-as-a-service/appset.yaml |
            oc $(params.action) -f - -n openshift-gitops
        - name: VERSION
          value: latest
      runAfter:
        - git-clone
      taskRef:
        params:
          - name: kind
            value: task
          - name: name
            value: openshift-client
          - name: namespace
            value: openshift-pipelines
        resolver: cluster
      workspaces:
        - name: manifest_dir
          workspace: source
  workspaces:
    - name: source
      optional: false
  finally: []
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerBinding
metadata:
  name: vm-as-a-service-trigger-binding
spec:
  params:
    - name: action
      value: $(body.action)
    - name: tenant
      value: $(body.tenant)
---
apiVersion: triggers.tekton.dev/v1alpha1
kind: TriggerTemplate
metadata:
  name: vm-as-a-service-trigger-template
spec:
  params:
    - name: action
    - name: tenant
  resourcetemplates:
    - apiVersion: tekton.dev/v1beta1
      kind: PipelineRun
      metadata:
        generateName: vm-as-a-service-pipeline-$(tt.params.tenant)-
      spec:
        params:
          - name: action
            value: $(tt.params.action)
          - name: tenant
            value: $(tt.params.tenant)
        pipelineRef:
          name: vm-as-a-service
        serviceAccountName: pipeline
        workspaces:
          - name: source
            volumeClaimTemplate:
              spec:
                accessModes:
                  - ReadWriteOnce
                resources:
                  requests:
                    storage: 64Mi
                #storageClassName: ocs-external-storagecluster-ceph-rbd
                storageClassName: gp3-csi
                volumeMode: Filesystem
---
apiVersion: triggers.tekton.dev/v1alpha1
kind: EventListener
metadata:
  name: vm-as-a-service-event-listener
spec:
  namespaceSelector: {}
  resources: {}
  serviceAccountName: pipeline
  triggers:
    - bindings:
        - kind: TriggerBinding
          ref: vm-as-a-service-trigger-binding
      name: application-trigger
      template:
        ref: vm-as-a-service-trigger-template
---
kind: Route
apiVersion: route.openshift.io/v1
metadata:
  name: el-vm-as-a-service-event-listener
  labels:
    app.kubernetes.io/managed-by: EventListener
    app.kubernetes.io/part-of: Triggers
    eventlistener: vm-as-a-service-event-listener
  annotations:
    openshift.io/host.generated: 'true'
spec:
  to:
    kind: Service
    name: el-vm-as-a-service-event-listener
    weight: 100
  port:
    targetPort: http-listener
  wildcardPolicy: None
</code></pre>
</div>
</div>




<div class="ulist">
<ul>
<li>
<p>OpenShift Web Console</p>
</li>
<li>
<p>OpenShift Web terminal (web based OC CLI)</p>
</li>
<li>
<p>OpenShift DevSpaces (web based IDE)</p>
</li>
</ul>
</div>
</div>
</div>

<nav class="pagination" data-panel="menu">
  <span class="prev"><a class="nav-link" href="index.html">vm as a service</a></span>
  <span class="next"><a class="nav-link" href="webconsole.html">2. web console</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../assets/js/vendor/clipboard.js"></script>
<script src="../assets/js/site.js"></script>
<script async src="../assets/js/vendor/highlight.js"></script>
  </body>
</html>
